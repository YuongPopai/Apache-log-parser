# Apache-log-parser
Этот проект включает в себя две основные части: скрипт для чтения и анализа логов и API для доступа к данным логов через базу данных. Скрипт анализа логов читает файлы логов, извлекает необходимую информацию и отправляет её в базу данных. API, реализованный с использованием Flask, позволяет пользователям получать данные логов в формате JSON, фильтруя по IP-адресу и временным промежуткам, так же выборку можно использовать через консоль с помощью команды select_logs.

# Предварительные требования
Для работы с проектом вам понадобится Python 3.6 или выше и следующие библиотеки:
- Flask
- psycopg2

# Установка
1. Клонируйте репозиторий:
git clone https://github.com/your-username/log-analyzer-and-db-api.git

# Конфигурация
Отредактируйте файл `config.py`, чтобы указать параметры подключения к вашей базе данных и пути к файлам логов

# Запуск
1) для запуска api необходимо запустить файл api.py
2) для инициализации консольного приложения запустите main.py

# Использование API

API поддерживает следующие параметры запроса:
- `ip`: IP-адрес для фильтрации логов.
- `start_date`: Начальная дата временного промежутка (в формате ГГГГ-ММ-ДД)
- `end_date`: Конечная дата временного промежутка (в формате ГГГГ-ММ-ДД)

# консольное приложение
В консольном приложении есть 2 комнды:
1) select_logs - принимает от 0 до 2 дат в формате ГГГГ-ММ-ДД и необходимые столбцы. Все даты и столбцы являются необязательным параметрами и могут идти в любом порядке
2) init_export - команда собирает все логи согласно паттернам из ваших вайлов от отправляет в бд

# Автоматизация
data_sender.py автоматически собирает логи согласно установленному приежутку, его можно поменять на 153 строчке - 'schedule.every(5).seconds.do(main)'



# Возможные модификаторы
%h - IP-адрес клиента (например, 192.168.2.20 и 127.0.0.1).
%t - Время запроса в формате [день/месяц/год:час:минута:секунда часовой_пояс]
%r - Первая строка запроса
%>s - Статус ответа сервера
%b - Размер ответа в байтах

# Примеры работы api
1) http://127.0.0.1:5000/logs
2) http://127.0.0.1:5000/logs
3) http://127.0.0.1:5000/logs?ip=192.168.1.1
4) http://127.0.0.1:5000/logs?start_date=2024-06-01&end_date=2024-06-13


# примеры работы выборки из бд через консоль
1) select_logs
2) select_logs date_time weight
3) select_logs date_time weight
4) select_logs 2006-01-01
5) select_logs 2006-01-01 2010-01-01
6) select_logs date_time 2006-01-01 weight 2010-01-01
7) select_logs date_time 2006-01-01 
